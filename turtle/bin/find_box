
--find_box

--[[
  Put the turtle down right next to a 
  chest, then run this.  It will find 
  the cooords of the box and write them 
  to "etc/box.txt".

  You can specify a different filename 
  (but in etc/) with:
    > bin/find_box some_file_name.txt
--]]

os.loadAPI("lib/move")
os.loadAPI("lib/settings")

if not move.test_gps() then error("GPS system is down!") end
local x, y, z = gps.locate(2)
move.face_n()

local got_chest = false
for i = 1,4 do
    s, d = turtle.inspect()
    if s then
        if d.name == 'minecraft:chest' then
            got_chest = true
            local f = move.d()
            if f == 'n' then z = z - 1
                elseif f == 'e' then x = x + 1
                elseif f == 's' then z = z + 1
                elseif f == 'w' then x = x - 1
            end
        end
    else
        move.r()
    end
end

if got_chest then
    print("I found a box at "..x..", "..y..", "..z..".")
    settings.set('box_x', x)
    settings.set('box_y', y)
    settings.set('box_z', z)
else
    error("I was unable to find a box - be sure you put me down right next to one.")
end


 -- vim: syntax=lua

